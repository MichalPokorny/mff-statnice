\subsection{ER-diagramy, metody návrhu IS}

ER-diagramy jsou de-facto standard pro konceptuální datové modelování. Jsou vhodné hlavnì pro \uv{plochá} neformátovaná data, tj. hlavnì pro relaèní, objektovì-relaèní nebo objektové databáze. Nejsou vhodné pro multimediální nebo hierarchická data (jako napø. XML). E-R v názvu znamená \emph{entity-relationship} modelování, tedy modelování s pomocí (tøíd) entit a jejich vztahù. ER model databáze definuje její konceptuální schéma. Jde vlastnì o obdobu UML schémat v objektovém programování.

\begin{obecne}{Entitní typ}
\emph{Entitní typ} (v diagramu se znaèí hranatým rámeèkem) reprezentuje nìjakou tøídu entit (napø. \uv{Zamìstnanec}). Každý entitní typ má nìjaké \emph{atributy} (napø. \uv{jméno}), z nichž nìkteré mohou být \emph{identifikátory}, tj. takové, které jednoznaènì urèují instanci entity. Pokud nemá žádné identifikátory explicitnì oznaèené, jsou jimi všechny atributy dohromaty (tzv. složený identifikátor). Identifikátory mohou být i víceatributové. 

Atributy entitních typù mohou být \emph{jednoduché} nebo \emph{složené}, \emph{povinné} èi \emph{nepovinné}, pøípadnì \emph{jednohodnotové} a \emph{vícehodnotové}. Jejich zobrazení ukazuje následující obrázek:

\begin{center}
\includegraphics[width=14cm]{informatika/databazy/obrazky/er1.png}

(Entitní typ se všemožnými druhy atributù)
\end{center}
\end{obecne}

\begin{obecne}{Vztahový typ}
\emph{Vztahový typ} (v diagramu znaèený kosoètvercem) popisuje vztahy mezi jednotlivými entitami -- s tìmi entitami, se kterými je v nìjakém vztahu, je spojen èarou. Vztah mùže mít danou i \emph{kardinalitu} (kolik entit z každé strany do vztahu vstupuje), která mùže být typu $1:1$, $1:n$, $m:n$ a je znaèená vedle èáry spojující vztahový typ s entitou. Entity ve vztahu mohou mít navíc \emph{povinné èi nepovinné èlenství} (vstupovat do nìj vždy nebo jen nìkdy).

Vztahy mohou být buï binární nebo obecnì $n$-ární, ale více než ternární vztahy se vìtšinou neobjevují. Vztahy mohou být i rekurzivní, tj. do vztahù vstupují entity stejného typu. Instance vztahového typu je jednoznaènì urèena identifikátory instancí entit ve vztahu. Nìkteré entitní typy mohou být spoluidentifikovány (nebo pøímo identifikovány) vztahem -- pak se nazývají \emph{slabé entitní typy}.

\begin{center}
\includegraphics[width=12cm]{informatika/databazy/obrazky/er2.png}

(Vztahové typy)
\end{center}
Obrázek ukazuje ternární vztah s rùznými kardinalitami -- klientovi nìkdo dodává zboží jednou až $n$-krát, pracovník dodává nula až $n$-krát zboží (tj. jde o nepovinné èlenství ve vztahu, mùžou existovat pracovníci, kteøí nic nedodávají) a zboží je vždy nìkomu dodáváno právì jednou. Na zamìstnancích je zároveò ukázán rekurzivní binární vztah.


\begin{center}
\includegraphics[width=10cm]{informatika/databazy/obrazky/er3.png}

(Slabý entitní typ. Zdroj: slidy Dr. T. Skopala k Databázovým systémùm)
\end{center}
Tento obrázek ukazuje, jak vypadá slabý entitní typ -- automobil je identifikován svojí SPZ a zároveò státem, ve kterém je registrován.
\end{obecne}


\begin{obecne}{ISA hierarchie}
ISA hierarchie je rozšíøení ER diagramù o \uv{dìdiènost} entit -- tj. rozdìlení entitních typù na subtypy (a pøidání dalších vztahù nebo atributù pro subtypy). V ISA hierarchii se povoluje pouze jednonásobná dìdiènost, navíc potomci nìjakého entitního typu musí být jednoznaènì identifikováni pøedkem (tj. všechny entity v hierarchii sdílí identifikátor).

\begin{center}
\includegraphics[width=6cm]{informatika/databazy/obrazky/er4.png}

(ISA hierarchie. Zdroj: slidy Dr. T. Skopala k Databázovým systémùm)
\end{center}
\end{obecne}

\begin{obecne}{Úpravy ER diagramù}
V ER diagramu je možné provádìt víceménì \uv{ekvivalentní} úpravy (výsledný diagram reprezentuje stejný koncept databáze), napø. pro odstranìní vztahù s kardinalitou $m:n$ (pøevod na dva vztahy kardinalitami $1:n$ a \emph{prùnikový entitní typ}, který je vztahy urèený, takže je slabý). Dalším dùvodem úprav mùže být zbavení se ISA hierarchie. To se dá provést více zpùsoby, pøièemž žádný z nich nefunguje úplnì obecnì:
\begin{pitemize}
    \item agregace atributù a vztahù potomka do pøedka a úprava kardinalit (pøevod na nepovinné atributy a nepovinné èlenství ve vztahu)
    \item odstranìní pøedka a duplikace všech jeho atributù a vztahù v potomcích
    \item nahrazení ISA vztahu klasickým vztahem (z potomkù vzniknou slabé entitní typy)
\end{pitemize}
Jiná úprava je odstranìní vícehodnotového atributu -- pøevede se na vztah s kardinalitou $1:n$ a slabý entitní typ.
\end{obecne}

\begin{obecne}{Korektní ER schéma}
V \emph{korektním} ER schématu všechny entity a vztahy splòují:
\begin{pitemize}
    \item Žádný entitní typ nemá více než jednoho ISA pøedka.
    \item ISA vztahy netvoøí orientovaný cyklus.
    \item Identifikaèní vztahy netvoøí orientovaný cyklus.
    \item Potomek v ISA hierarchii není identifikaènì závislý na žádném entitním typu (je již identifikován pøedkem).
    \item Jména entitních a vztahových typù jsou jednoznaèná.
\end{pitemize}
\end{obecne}


TODO: Co je ksakru \uv{ metody návrhù IS}?
